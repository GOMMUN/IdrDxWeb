<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.idr.pdd.mapper.DashMapper">

    <select id="findAll1" parameterType="WorkContents" resultType="WorkContents">
        SELECT
		    SUM(A.PROD_QTY) AS PROD_QTY, 
		    SUM(A.FIRSTTIME_FAIL_QTY) AS FIRSTTIME_FAIL_QTY
		FROM DSP_WORK_CONTENTS A  
		JOIN DSP_WORKDAILY_REPORT B
		ON B.DATASEQ=A.WORKDAILY_SEQ
			AND B.ISUSABLE='Usable'
		    AND A.ISUSABLE = 'Usable'
		    AND B.WORK_DATE = CONVERT(DATE, GETDATE(), 112)
    </select>
    
    <select id="findAll4" parameterType="WorkContents" resultType="WorkContents">
        SELECT
		    SUM(A.PROD_QTY) AS PROD_QTY, 
		    SUM(A.FIRSTTIME_FAIL_QTY) AS FIRSTTIME_FAIL_QTY
		FROM DSP_WORK_CONTENTS A  
		JOIN DSP_WORKDAILY_REPORT B
		ON B.DATASEQ=A.WORKDAILY_SEQ
			AND B.ISUSABLE='Usable'
		    AND A.ISUSABLE = 'Usable'
		    AND B.WORK_DATE = CONVERT(DATE, GETDATE()-1, 112)
    </select>
    
    <select id="findAll2" parameterType="RejectContents" resultType="RejectContents">
        SELECT 
        	A.REJECT_ITEMID,
        	SUM(A.FIRSTTIME_REJECT_QTY) AS FIRSTTIME_REJECT_QTY
        FROM DSP_REJECT_CONTENTS A
        JOIN DSP_WORKDAILY_REPORT B
        ON B.DATASEQ=A.WORKDAILY_SEQ
			AND B.FACTORYID ='KEM'
			AND B.ISUSABLE ='USABLE'
       		AND A.ISUSABLE = 'Usable'
       		AND DATEPART(MONTH,B.WORK_DATE) = #{month}
       	GROUP BY A.REJECT_ITEMID
    </select>
    
    <select id="findAll3" parameterType="RejectContents" resultType="RejectContents">
        SELECT 
        	A.REJECT_ITEMID,
        	A.REJECT_TYPE,
        	SUM(A.FIRSTTIME_REJECT_QTY) AS FIRSTTIME_REJECT_QTY
        FROM DSP_REJECT_CONTENTS A
        JOIN DSP_WORKDAILY_REPORT B
        ON B.DATASEQ=A.WORKDAILY_SEQ
			AND B.FACTORYID ='KEM'
			AND B.ISUSABLE ='USABLE'
       		AND A.ISUSABLE = 'Usable'
       		AND DATEPART(MONTH,B.WORK_DATE) = DATEPART(MONTH, GETDATE())
       	GROUP BY A.REJECT_ITEMID, REJECT_TYPE
    </select>

</mapper>